local TextBox = script.Parent.Parent:FindFirstChild("UsernameInput") -- Reference the TextBox
local Button = script.Parent -- Reference the button

local Players = game:GetService("Players")
local InsertService = game:GetService("InsertService")

Button.MouseButton1Click:Connect(function()
    local username = TextBox.Text
    if username ~= "" then
        -- Attempt to fetch the player's UserId
        local success, userId = pcall(function()
            return Players:GetUserIdFromNameAsync(username)
        end)

        if success and userId then
            -- Fetch the player's avatar and create a dummy
            local success2, avatarModel = pcall(function()
                return Players:GetCharacterAppearanceAsync(userId)
            end)

            if success2 and avatarModel then
                local dummy = Instance.new("Model") -- Create a new dummy model
                dummy.Name = username .. "_Dummy"

                for _, child in pairs(avatarModel:GetChildren()) do
                    child.Parent = dummy
                end

                -- Add a Humanoid to the dummy
                local humanoid = Instance.new("Humanoid")
                humanoid.Parent = dummy

                -- Set up the dummy in the workspace
                dummy.Parent = workspace
                dummy:SetPrimaryPartCFrame(workspace.CurrentCamera.CFrame * CFrame.new(0, 5, -10)) -- Adjust spawn position
            else
                warn("Failed to load avatar for username.")
            end
        else
            warn("Invalid username or user does not exist.")
        end
    else
        warn("Please enter a username.")
    end
end)
